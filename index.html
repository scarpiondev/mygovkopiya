<!doctype html>
<html lang="uz">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Hujjat - Kirish</title>
<style>
  :root{
    --bg:#f5f7f8;
    --card:#ffffff;
    --muted:#6b7280;
    --green:#2ea44f;
    --maxw:920px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter, Arial, Helvetica, sans-serif;
    background:var(--bg);
    color:#222;
    -webkit-font-smoothing:antialiased;
    padding-top: env(safe-area-inset-top);
  }
  .container{max-width:var(--maxw);margin:0 auto;padding:18px}
  .header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img.logo{width:46px;height:46px;border-radius:8px;object-fit:cover;display:block;background:#fff;border:1px solid rgba(0,0,0,0.04);box-shadow:0 6px 18px rgba(11,22,37,0.06)}
  .brand .title{font-weight:700;font-size:15px}
  .brand .subtitle{font-size:12px;color:var(--muted);margin-top:2px}
  .burger{width:44px;height:44px;border-radius:10px;background:#fff;border:1px solid rgba(0,0,0,0.06);display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(11,22,37,0.06)}
  .burger .lines{width:20px;height:14px;position:relative}
  .burger .lines span{position:absolute;left:0;right:0;height:2px;background:#333;border-radius:2px}
  .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 10px 40px rgba(11,22,37,0.06);border:1px solid rgba(0,0,0,0.03)}
  .alert{background:#fff7e6;border:1px solid #ffe8b5;padding:12px;border-radius:8px;color:#6b4b00;margin-bottom:12px;font-size:13px}
  .pin-row{display:flex;gap:10px;align-items:center}
  .pin-input{flex:1;background:#fff;border:1px solid #e6e6e6;padding:12px 14px;border-radius:8px;font-size:15px}
  .open-btn{display:block;width:100%;margin-top:10px;background:var(--green);color:#fff;border:0;padding:12px;border-radius:8px;font-weight:700;font-size:15px;cursor:pointer;box-shadow:0 8px 20px rgba(46,164,79,0.16)}
  .hint{font-size:13px;color:var(--muted);margin-top:10px}
  #error{color:#c92a2a;margin-top:8px;font-size:13px}
  .preview-wrap{margin-top:20px;display:flex;justify-content:center}
  .preview-card{width:100%;max-width:980px;background:#fff;border-radius:10px;padding:16px;box-shadow:0 18px 40px rgba(11,22,37,0.08);border:1px solid rgba(0,0,0,0.04)}
  .paper{background:linear-gradient(180deg,#ffffff 0,#f8fafc 100%);padding:12px;border-radius:6px;border:1px solid rgba(0,0,0,0.03)}
  .doc-placeholder img{display:block;width:100%;height:auto;border-radius:6px;max-width:420px;margin:0 auto;object-fit:cover}
  @media (max-width:720px){ .paper{padding:10px} }
</style>
</head>
<body>
  <div class="container">
    <header class="header" role="banner">
      <div class="brand">
        <img id="siteLogo" class="logo" src="assets/logo.png" alt="logo">
      </div>
      <div class="burger" aria-hidden="true" title="menu"><div class="lines"><span></span><span></span><span></span></div></div>
    </header>

    <main class="card" role="main">
      <div class="alert">Пожалуйста пройдите авторизацию чтобы система определила вас. Если документ принадлежит вам, введения ПИН кода не требуется.</div>

      <div>
        <div class="pin-row">
          <input id="pin" class="pin-input" type="text" inputmode="numeric">
        </div>
        <button id="openBtn" class="open-btn">Открыть</button>
        <div class="hint" style="color: blue;">PIN-kod размещается рядом с QR-кодом документа</div>
        <div id="error" role="alert"></div>
      </div>

      <div class="preview-wrap">
        <div class="preview-card">
          <div class="paper" id="previewPane">
            <div class="doc-placeholder" id="docPlaceholder">
              <img src="assets/hujjat.jpg" alt="Document preview">
            </div>
            <!-- No inline PDF viewer here — we will open the PDF in new tab -->
          </div>
        </div>
      </div>
    </main>
  </div>

<script>
(function(){
  // ---------- CONFIG ----------
  // Best: store PDF with site assets and use direct path
  const PDF_URL = "/assets/document.pdf";   // <-- put document.pdf in assets/
  // If you use external hosting, set public URL here:
  // const PDF_URL = "https://your-bucket.s3.amazonaws.com/document.pdf";

  const STORED_PIN = "9876"; // set actual PIN here
  // ---------- END CONFIG ----------

  const pinInput = document.getElementById('pin');
  const openBtn = document.getElementById('openBtn');
  const errorEl = document.getElementById('error');

  function reverseString(s){ return s.split('').reverse().join(''); }

  openBtn.addEventListener('click', function(){
    errorEl.textContent = '';
    const v = (pinInput.value || '').trim();
    if (!v) {
      errorEl.textContent = 'Iltimos PDFdagi PINni kiriting.';
      return;
    }

    // accept normal OR reversed PIN
    if (v === STORED_PIN || reverseString(v) === STORED_PIN) {
      // Try open in new tab/window
      try {
        const newWin = window.open(PDF_URL, '_blank', 'noopener,noreferrer');
        if (!newWin) {
          // Popup blocked -> open in same tab (fallback)
          window.location.href = PDF_URL;
        } else {
          // For many browsers, you may want to focus
          newWin.focus && newWin.focus();
        }
      } catch (e) {
        // Fallback if anything throws
        window.location.href = PDF_URL;
      }
    } else {
      errorEl.textContent = "PIN noto‘g‘ri. Iltimos PDFdagi PINni tersa kiriting.";
    }
  });

  // Allow Enter key
  pinInput.addEventListener('keydown', function(e){
    if (e.key === 'Enter') openBtn.click();
  });
})();
</script>
</body>
</html>
